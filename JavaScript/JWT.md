# JWT
유저를 인증하고 식별하기 위한 토큰기반 인증 방식이다. 클라이언트에 저장되며, 토큰 자체에 사용자의 권한이나 식별정보를 포함한다.

JWT를 사용하면 무상태(stateless)를 유지하며 사용자 데이터를 주고 받을 수 있게 된다.

# JWT의 구조
헤더(Header), 페이로드(payload), 시그니처(Signature)로 구성되고, 각 요소는 "."으로 구분된다.

Header.payload.Signature

* 헤더 - 타입, 해시 알고리즘의 종류
* 페이로드 - 서버에서 첨부한 사용자 정보. 클레임(Claim)이라고 표현하며 key/value의 형태이다.
* 시그니처 - 헤더와 페이로드에 Base64 URL-safe Encode를 적용하고 해싱한 뒤, 비밀키로 서명한 전자서명

## JWT의 특징
#### 장점
* 범용적이고 규격이 정해져있어 다양한 클라이언트에서 활용할 수 있다.
* RESTful 등 무상태 환경에서도 통신이 용이하다.
* 자체적으로 데이터를 지니고 있어 요청의 횟수를 줄일 수 있다.

#### 단점
* 길이가 길어서 서버에 부담을 줄 수 있다.
* 토큰을 재발급하지 않으면 유저 정보가 갱신되지 않는다.
* 탈취당할 경우 토큰 만료까지 기다려야 한다.

## JWT의 저장
크게 쿠키(Cookie)에 저장하거나 로컬 스토리지(Local Storage)에 저장한다.

#### 쿠키
* XSS 공격에 비교적 강하고, secure옵션(httpOnly, samesite 등)을 이용하면 안전성을 높일 수 있다.
* 자동으로 HTTP request에 담기기 때문에 CSRF 공격에 약하다.
* 상황에따라 쿠키를 쓰지 못할 수 있고, 브라우저별로 쿠키 정책이 다르다.

#### 로컬 스토리지
* 사용하기 간편하고 어느 요청(Request)에 토큰을 추가할지 명시적으로 지정할 수 있다.
* CSRF 공격에 비교적 안전하다.
* 로컬 XSS에 약하다.

쿠키에 저장해야 한다고 주장하는 측은 쿠키가 로컬 스토리지보다 안전하고 매번 서버에 보내야하는 토큰의 성격과도 어울리는 점을 말한다.

반대로 로컬 스토리지에 저장해야 한다고 주장하는 측은 어차피 XSS 공격은 대비를 해야하고, 토큰은 각 브라우저 별로 정책이 다를 뿐더러 늘 쿠키를 사용할 수 있다는 보장이 없다는 점을 말한다.