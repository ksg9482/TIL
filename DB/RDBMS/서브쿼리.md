# 서브쿼리
서브쿼리란 하나의 sql문에 포함되어 있는 또다른 sql문을 말한다.   
   
### 사용시 주의사항
* 서브쿼리는 괄호()로 감싸서 사용한다
* 서브쿼리는 단일 행 또는 복수행 비교 연산자와 함께 사용 가능하다.
* 서브쿼리에서는 ORDER BY를 사용하지 못한다.
   
### 서브쿼리를 사용 할 수 있는 곳
* SELECT 절
* FROM 절
* WHRER 절
* HAVING  절
* ORDER BY 절
* INSERT 문의 VALUES 절
* UPDATE 문의 SET 절
   
### 서브쿼리의 분류
#### 단일 행
서브쿼리가 단일 행 비교연산자와 함께 사용될 때는 서브쿼리의 결과 건수가 반드시 1건 이하여야 한다. 2건 이상이면 오류가 발생한다.   
만약 그룹함수를 사용한다면 결과 값이 1건이기 때문에 단일 행 서브쿼리로 사용 가능하다.   
   
#### 다중 행
서브쿼리의 결과가 2건이상 반환될 수 있다면 반드시 다중 행 비교 연산자(IN, ALL, ANY, SOME)와 함께 사용해야 한다.   
* IN: 서브쿼리의 결과에 존재하는 임의의 값과 동일한 조건을 의미한다.
* ALL: 서브쿼리의 결과에 존재하는 모든 값을 만족하는 조건을 의미한다.
* ANY: 서브쿼리의 결과에 존재하는 어느 하나의 값이라도 만족하는 조건을 의미한다.
* EXISTS: 서브쿼리의 결과를 만족하는 값이 존재하는지 여부를 확인하는 조건을 의미한다.
   
#### 다중 컬럼 서브쿼리
서브쿼리의 결과로 여러개의 컬럼이 반환되어 메인쿼리의 조건과 동시에 비교되는 것을 의미한다.   
   
#### 연관 서브쿼리
서브쿼리 내에 메인쿼리 컬럼이 사용된 서브쿼리를 의미한다.   
   
#### 그 밖의 위치에서 사용하는 서브쿼리
* SELECT 절에 사용하는 서브쿼리: 스칼라 서브쿼리라고도 하며 한 행, 한 컬럼만을 반환하는 서브쿼리를 의미한다. 
* FROM 절에 사용하는 서브쿼리: 인라인 뷰라고 한다. 기본적으로 FROM 절에는 테이블 명이 오도록 되어있으나, 서브쿼리가 사용되면 동적으로 생성된 테이블인 것 처럼 사용 할 수 있다.
인라인 뷰는 SQL문이 실행될 때만 임시로 생성되기 때문에 데이터베이스에 정보가 저장되지 않고, 또 동적으로 조인 방식을 사용하는 것과 같다.
* HAVING 절에 사용하는 서브쿼리: 그룹함수와 함께 사용될 때 그룹핑된 결과에 대해 부가적인 조건을 주기 위해 사용한다.

### 뷰 사용의 장점
* 독립성: 테이블 구조가 변경되어도 뷰를 사용하는 응용 프로그램은 변경하지 않아도 된다.
* 편리성: 복잡한 질의를 뷰로 생성함으로써 관련 질의를 단순하게 작성할 수 있다.
* 보안성: 숨기고 싶은 정보가 존재하는 경우 뷰를 생성 할 때 해당 컬럼을 빼고 생성하여 정보를 숨길 수 있다.

___
출처: https://mozi.tistory.com/233
